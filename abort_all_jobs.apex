// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ABORT ALL JOBS - Before restarting with the fixed version
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

System.debug('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');
System.debug('ğŸ›‘ ABORTING ALL JOBS');
System.debug('â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•');

// Abort running batches
List<AsyncApexJob> runningJobs = [
    SELECT Id, Status
    FROM AsyncApexJob 
    WHERE ApexClass.Name = 'DataCloudBatchProcessor'
    AND Status IN ('Processing', 'Queued', 'Preparing')
];

System.debug('Aborting ' + runningJobs.size() + ' running jobs...');
for (AsyncApexJob job : runningJobs) {
    try {
        System.abortJob(job.Id);
        System.debug('âœ“ Aborted: ' + job.Id);
    } catch (Exception e) {
        System.debug('Failed: ' + job.Id);
    }
}

// Abort scheduled jobs
List<CronTrigger> scheduledJobs = [
    SELECT Id, CronJobDetail.Name
    FROM CronTrigger 
    WHERE CronJobDetail.Name LIKE 'DataCloudBatchProcessor%'
];

System.debug('Aborting ' + scheduledJobs.size() + ' scheduled jobs...');
for (CronTrigger job : scheduledJobs) {
    try {
        System.abortJob(job.Id);
        System.debug('âœ“ Aborted: ' + job.CronJobDetail.Name);
    } catch (Exception e) {
        System.debug('Failed: ' + job.Id);
    }
}

Integer currentCount = [SELECT COUNT() FROM Opportunity];
System.debug('');
System.debug('Current opportunities: ' + currentCount);
System.debug('');
System.debug('âœ… All jobs aborted! Ready to restart with fix.');
System.debug('Next: Run restart_with_2min_delays.apex');




